name: Prepare release
description: Prepare a new release
inputs:
  version:
    description: Version to release
    required: true
  specfiles:
    description: Comma-separated list of spec files to update
    required: true
  prerelease_suffix_pattern:
    description: Regular expression specifying recognized pre-release suffixes
    default: "([.\\-_~^]?)(alpha|beta|rc|pre(view)?)([.\\-_]?\\d+)?"
  prerelease_suffix_macro:
    description: Macro in a spec file that controls whether version is a pre-release
    default: ""
  token:
    description: A `repo` scoped Personal Access Token (PAT)'. Defaults to (autogenerated) secret.GITHUB_TOKEN
    default: ${{ github.token }}
runs:
  using: "docker"
  image: "Dockerfile"
  args:
    - --prerelease-suffix-pattern="${{ inputs.prerelease_suffix_pattern }}"
    - --prerelease-suffix-macro="${{ inputs.prerelease_suffix_macro }}"
    - ${{ inputs.version }}
    - ${{ inputs.specfiles }}
